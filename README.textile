h1. oui_cookie <img src="https://img.shields.io/badge/Textpattern-4.5+-brightgreen.svg" /> <img src="https://img.shields.io/github/release/NicolasGraph/oui_cookie.svg" />

This plugin allows to set, read, reset or delete a cookie manually or through a HTTP variable.
It is also possible to check the status or the value of a defined cookie, on setting or once set.

*Warning:* According to the EU legislation you must warn your users if your website set cookies.

"Download":https://github.com/NicolasGraph/oui_cookie/releases | "Donate":https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=PREHX3MZMXEUN

h2. Table of contents

* "Plugin requirements":#requirements
* "Installation":#installation
* "Tags":#tags
** "oui_cookie":#oui_cookie
** "oui_if_cookie":#oui_if_cookie
* "Examples":#examples
** "Front end articles sorting":#sort_by
** "Last viewed article":#last_viewed
** "EU cookies warning":#eu_cookies
* "Author":#author
* "Licence":#licence

h2(#requirements). Plugin requirements

oui_cookie requires Textpattern 4.5+.

h2(#installation). Installation

# Paste the content of the plugin file under the *Admin > Plugins* tab, upload, install and enable it;
# Set your tags…

h2(#tags). tags

h3(#oui_cookie). oui_cookie

bc. <txp:oui_cookie name="…" />

or

bc.. <txp:oui_cookie name="…">
    […]
</txp:oui_cookie>

h4. Attributes

h5. Required

* @name@ - _default: unset_ - The cookie (and HTTP variable) name you want to use. If no other attibutes are defined, the tag will read and display the related value.

h5. Manually set a cookie

* @value@ - _default: unset_ - A value to manually set the named cookie.
You can also set the cookie value by using a continer tag like you would for a variable.

h5. Set a cookie through a HTTP variable

* @values@ - _default: unset_ - A comma separated list of accepted values for the url variable and its cookie.
* @default@ - _default: unset_ - A default value.
If set, the plugin conditional tag will always be true if not check against a defined value.

h5. Optional cookie settings

* @duration@ - _default: +1 day_ - A "strtotime":http://php.net/manual/fr/function.strtotime.php value to set the cookie duration.

h5. Delete a cookie

* @delete@ - _default: 0_ - If set to _1_ this attribute will delete the named cookie.

h3(#oui_cookie). oui_if_cookie

bc.. <txp:oui_if_cookie name="…">
    […]
<txp:else />
    […]
</txp:oui_if_cookie>

p. This tag checks the status or the value of the cookie (and/or the related HTTP variable) defined by the @name@ attribute.

h4. Attributes

h5. Required

* @name@ - _default: unset_ - The cookie (and HTTP variable) name you want to use.

h5. Optional

* @value@ - _default: unset_ - A value to check against the cookie (and/or the HTTP variable) value.

h2(#examples). Examples

h3(#sort_by). Front end articles sorting

List the sort options you want to use:

bc.. <select onchange="window.location.href=this.value">
    <option value="" disabled selected>Sort by</option>
    <option value="?sort_by=custom_1">Size</option>
    <option value="?sort_by=custom_2">Weight</option>
</select>

p. Then, catch the HTTP variable sent by this list to store it (useful to keep the sort order pages after pages).

bc. <txp:oui_cookie name="sort_by" values="custom_1, custom_2" default="custom_1" />

Now use the new value as the value of the @sort@ attribute of your article tag.

bc. <txp:article sort='<txp:oui_cookie name="sort_by" />' />

h3(#last_viewed). Last viewed article

Store the current article id in a cookie:

bc. <txp:if_individual_article>
    <txp:oui_cookie name="last_article" value='<txp:article_id />' />
</txp:if_individual_article>

Now, use the following code anywhere you want to display the last viewed article.

bc. <txp:if_cookie name="last_article">
    <txp:article_custom id='<txp:oui_cookie name="last_article" />' />
</txp:if_cookie>

h3(#eu_cookies). EU cookies Warning

bc.. <txp:oui_cookie name="accept_cookies" values="yes" />

<txp:oui_if_cookie name="accept_cookies">
<txp:else />
    This website uses cookies. <a href="?accept_cookies=yes">I accept!</a>
</txp:oui_if_cookie>

h2(#author). Author

"Nicolas Morand":http://github.com/NicolasGraph, inspired by a "Jukka Svahn":http://rahforum.biz/ "tip":http://textpattern.tips/setting-cookies-for-eu-legislation.

h2(#licence). Licence

This plugin is distributed under "GPLv2":http://www.gnu.org/licenses/gpl-2.0.fr.html.
